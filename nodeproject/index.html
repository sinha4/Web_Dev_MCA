<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>‚òï Caf√© Bliss Menu</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Import a more stylish, cozy font -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Raleway:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Raleway', sans-serif;
    }
    h1, h2 {
      font-family: 'Playfair Display', serif;
    }
  </style>
</head>
<body class="bg-gradient-to-b from-amber-50 to-orange-100 min-h-screen">

  <!-- Header with background image -->
  <header class="relative bg-amber-900 text-white shadow-lg">
    <div class="absolute inset-0">
      <img src="./assets/76ca70a3e12ca472b6baa51470056a32.jpg" 
           alt="Cafe background" class="w-full h-full object-cover opacity-30">
    </div>
    <div class="relative z-10 max-w-6xl mx-auto py-12 text-center">
      <h1 class="text-5xl font-bold drop-shadow-lg">The Pastel Mugg</h1>
      <p class="mt-2 text-lg italic text-amber-100">Fresh Brews & Homemade Treats</p>
    </div>
  </header>

  <!-- Filters -->
  <section class="max-w-5xl mx-auto mt-8 flex flex-col sm:flex-row gap-4 justify-center px-4">
    <input id="nameInput" type="text" placeholder="üîç Search by name..." 
           class="p-3 border border-amber-300 rounded focus:outline-none focus:ring-2 focus:ring-amber-500 w-full sm:w-60">
    <select id="categorySelect" 
            class="p-3 border border-amber-300 rounded focus:outline-none focus:ring-2 focus:ring-amber-500 w-full sm:w-40">
      <option value="">All Categories</option>
      <option value="Coffee">Coffee</option>
      <option value="Cold Coffee">Cold Coffee</option>
      <option value="Bakery">Bakery</option>
    </select>
    <button id="filterBtn" 
            class="bg-amber-700 hover:bg-amber-800 text-white px-5 py-3 rounded font-semibold shadow-md transition">
      Filter
    </button>
  </section>

  <!-- Menu Grid -->
  <section id="menuGrid" 
           class="max-w-6xl mx-auto mt-10 grid gap-10 sm:grid-cols-2 lg:grid-cols-3 px-4 pb-16">
  </section>

  <!-- Order Modal (just ONCE in the page!) -->
<div id="orderModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 hidden">
  <div class="bg-white rounded-xl shadow-2xl w-full max-w-md p-8 relative">
    <button id="closeModal" class="absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl">&times;</button>
    <h3 class="text-2xl font-semibold mb-4 text-amber-800">Place Order</h3>
    <form id="orderForm" class="space-y-4">
      <input id="customerName" type="text" required placeholder="Your Name" class="block w-full border p-2 rounded">
      <input id="customerPhone" type="tel" required placeholder="Phone Number" class="block w-full border p-2 rounded">
      <textarea id="customerAddress" required placeholder="Address" class="block w-full border p-2 rounded"></textarea>
      <button id="saveOrderBtn" type="submit" class="w-full bg-amber-700 hover:bg-amber-900 text-white px-4 py-2 rounded font-semibold">
        Save and Pay
      </button>
    </form>
  </div>
</div>


  <script>
    const API_URL = 'http://localhost:3000/api/menu';

async function fetchMenu(params = "") {
  const res = await fetch(`${API_URL}${params}`);
  return res.json();
}

function renderMenu(items) {
  const grid = document.getElementById('menuGrid');
  grid.innerHTML = "";
  if (items.length === 0) {
    grid.innerHTML = '<p class="text-gray-500 col-span-full text-center">No menu items found üçΩÔ∏è</p>';
    return;
  }
  items.forEach(item => {
    grid.innerHTML += `
      <div class="bg-white rounded-xl shadow-lg overflow-hidden h-100 hover:shadow-2xl transition transform hover:-translate-y-1">
        <!-- Image section (background and item image) -->
        <div class="relative w-full h-52 overflow-hidden rounded-t-xl">
          <div class="absolute inset-0 bg-cover bg-center opacity-80" style="background-image: url('/assets/76ca70a3e12ca472b6baa51470056a32.jpg');"></div>
          <img src="${item.image}" alt="${item.name}" class="relative w-40 h-60 object-cover ml-20 justify-center z-10">
        </div>
        <!-- Card content below -->
        <div class="p-5">
          <h2 class="text-2xl font-bold text-amber-800">${item.name}</h2>
          <p class="text-sm text-gray-500">${item.category}</p>
          <p class="mt-3 text-gray-700 leading-relaxed">${item.description}</p>
          <div class="mt-5 flex justify-between items-center">
            <span class="text-lg font-semibold text-green-600">‚Çπ${item.price}</span>
            <button
              class="bg-amber-700 hover:bg-amber-900 text-white px-4 py-2 rounded shadow"
              onclick="showOrderModal('${item.name.replace(/'/g, "\\'")}', ${item.id}, ${item.price})"
            >
              Order
            </button>
          </div>
        </div>
      </div>
    `;
  });
}

document.getElementById('filterBtn').addEventListener('click', async () => {
  const name = document.getElementById('nameInput').value.trim();
  const category = document.getElementById('categorySelect').value;
  const query = [];
  if (name) query.push(`name=${encodeURIComponent(name)}`);
  if (category) query.push(`category=${encodeURIComponent(category)}`);
  const params = query.length ? `?${query.join('&')}` : "";
  const menuItems = await fetchMenu(params);
  renderMenu(menuItems);
});

// Initial load
fetchMenu().then(renderMenu);

// --- Modal Logic ---
let currentOrderItem = null;

window.showOrderModal = function(itemName, itemId, itemPrice) {
  currentOrderItem = { name: itemName, id: itemId, price: itemPrice };
  document.getElementById('orderModal').classList.remove('hidden');
  document.getElementById('orderForm').reset();
};

document.getElementById('closeModal').onclick = function() {
  document.getElementById('orderModal').classList.add('hidden');
};

document.getElementById('orderForm').onsubmit = function(e) {
  e.preventDefault();
  // Collect user info
  const userInfo = {
    name: document.getElementById('customerName').value.trim(),
    phone: document.getElementById('customerPhone').value.trim(),
    address: document.getElementById('customerAddress').value.trim(),
    orderItem: currentOrderItem
  };

  // Save to localStorage
  let orders = JSON.parse(localStorage.getItem('orders') || '[]');
  orders.push(userInfo);
  localStorage.setItem('orders', JSON.stringify(orders));

  // Confirmation
  alert('User details saved! Redirecting to payment...');

  // Close modal
  document.getElementById('orderModal').classList.add('hidden');

  // Redirect to payment gateway with user/item info
const paymentUrl = `https://www.google.com/search?q=${encodeURIComponent(userInfo.orderItem.name)}`;
window.location.href = paymentUrl;
  window.location.href = paymentUrl;
};


  </script>
</body>
</html>
